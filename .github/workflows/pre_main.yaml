name: Test Incoming Changes

on:  # yamllint disable-line rule:truthy
  push:
    branches:
      - main
  pull_request:
    branches:
      - main

jobs:
  lint:
    name: Run Linter and Vet
    runs-on: ubuntu-22.04

    steps:
      - name: Set up Go 1.18
        uses: actions/setup-go@v2
        with:
          go-version: 1.18.9

      - name: Check out code into the Go module directory
        uses: actions/checkout@v2
        # with:
        #   ref: ${{ github.sha }}

      - name: ls
        run: ls -lisa

      # TODO: golangci-lint team recommends using a GitHub Action to perform golangci-lint responsibilities.  However
      # there does not appear to be a way to honor our existing .golangci.yml.  For now, mimic developer behavior.
      # - name: Install golangci-lint
      #   run: make install-lint

      # - name: make lint
      #   run: make lint

      # - name: make vet
      #   run: make vet

  yamllint:
    runs-on: ubuntu-22.04
    steps:
      - uses: actions/checkout@v2

      - name: yaml-lint
        uses: ibiqlik/action-yamllint@v3
        with:
          no_warnings: true
